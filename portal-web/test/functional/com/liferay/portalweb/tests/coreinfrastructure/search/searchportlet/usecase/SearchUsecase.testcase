@component-name = "portal-search"
definition {
	property portal.release = "true";
	property portal.suite.search.engine = "elasticsearch2,elasticsearch6,solr";
	property portal.upstream = "true";
	property testray.main.component.name = "Web Search";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();
	}

	tearDown {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if ("${testPortalInstance}" == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			BlogsEntry.tearDownCP();

			WikiPage.tearDownCP();

			WebContent.tearDownCP();

			DMDocument.tearDownCP();

			User.tearDownCP();

			Page.tearDownPG();
		}
	}

	@priority = "4"
	test SearchAssetsScopeEverythingAcrossMultipleSites {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name 0");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Site Page", siteName = "Site Name 0");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name 0");

		Search.searchPG(searchTerm = "test");

		Search.viewSearchResultPG(
			searchAssetTitle = "Test Test",
			searchAssetType = "User"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name 1");

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContentNavigator.gotoAddCP();

		WebContent.addCP(
			webContentContent = "WC WebContent Content",
			webContentTitle = "Apple"
		);

		PortletEntry.publish();

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name 2");

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Documents and Media"
		);

		DMDocument.addCP(
			dmDocumentDescription = "DM Document Description",
			dmDocumentFile = "Document_1.doc",
			dmDocumentTitle = "Apple"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name 3");

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Blogs"
		);

		Blogs.addEntry(entryContent = "Blogs Entry Content", entryTitle = "Apple");

		Navigator.openURL();

		Portlet.gotoPortletOptions(
			portletName = "Search",
			portletOption = "Configuration"
		);

		Search.configureSearchScopePG(searchScope = "Everything");

		Navigator.openURL();

		Search.searchPG(searchTerm = "Apple");

		Search.viewSearchResultsPG(
			searchAssetTitle = "Apple",
			searchAssetType = "Web Content Article"
		);

		Search.viewSearchResultsPG(
			searchAssetTitle = "Apple",
			searchAssetType = "Document"
		);

		Search.viewSearchResultsPG(
			searchAssetTitle = "Apple",
			searchAssetType = "Blogs Entry"
		);

		Navigator.openURL();

		Search.searchPG(searchTerm = "*");

		Search.viewSearchResultPG(
			searchAssetTitle = "Test Test",
			searchAssetType = "User"
		);
	}

	@priority = "4"
	test SearchByPermission {
		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContentNavigator.gotoAddCP();

		WebContent.addCP(webContentContent = "WC Content", webContentTitle = "WC Title");

		PortletEntry.publish();

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn"
		);

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.editPasswordCP(
			password = "password",
			userEmailAddress = "userea@liferay.com",
			userScreenName = "usersn"
		);

		ProductMenu.gotoPortlet(
			category = "Members",
			panel = "Site Administration",
			portlet = "Site Memberships"
		);

		Site.addAllMembersCP();

		User.logoutPG();

		User.loginUserPG(password = "test", userEmailAddress = "userea@liferay.com");

		var siteName = TestCase.getSiteName(siteName = "${siteName}");

		ProductMenu.gotoSite(site = "${siteName}");

		Search.searchPG(searchTerm = "WC Title");

		Search.viewSearchResultPG(
			searchAssetTitle = "WC Title",
			searchAssetType = "Web Content Article"
		);
	}

	@priority = "4"
	test SearchByUserFacet {
		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn"
		);

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.editPasswordCP(
			password = "password",
			userEmailAddress = "userea@liferay.com",
			userScreenName = "usersn"
		);

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.assignRegularRoleCP(roleName = "Administrator", userScreenName = "usersn");

		Navigator.openURL();

		Page.add(pageName = "Blogs Page");

		Navigator.gotoPage(pageName = "Blogs Page");

		Portlet.addPG(portletName = "Blogs");

		Blogs.addEntry(
			entryContent = "Blogs Super Admin Entry Content",
			entryTitle = "Blogs Super Admin Entry Title"
		);

		User.logoutPG();

		User.firstLoginPG(password = "test", userEmailAddress = "userea@liferay.com");

		Navigator.gotoPage(pageName = "Blogs Page");

		Blogs.addEntry(
			entryContent = "Blogs User Entry Content",
			entryTitle = "Blogs User Entry Title"
		);

		Navigator.gotoPage(pageName = "Blogs Page");

		Search.searchPG(searchTerm = "Entry");

		Search.viewUserFacetPG(
			facetFrequency = "1",
			searchAssetSummary = "Blogs Super Admin Entry Content",
			searchAssetTitle = "Blogs Super Admin Entry Title",
			searchAssetType = "Blogs Entry",
			userLoginFullName = "Test Test"
		);

		Search.viewSearchNoPG(
			searchAssetSummary = "Blogs User Entry Content",
			searchAssetTitle = "Blogs User Entry Title",
			searchAssetType = "Blogs Entry"
		);

		AssertClick(locator1 = "SearchResults#USER_FACET_ANY_USER", value1 = "Any User");

		Search.viewUserFacetPG(
			facetFrequency = "1",
			searchAssetSummary = "Blogs User Entry Content",
			searchAssetTitle = "Blogs User Entry Title",
			searchAssetType = "Blogs Entry",
			userLoginFullName = "userfn userln"
		);

		Search.viewSearchNoPG(
			searchAssetSummary = "Blogs Super Admin Entry Content",
			searchAssetTitle = "Blogs Super Admin Entry Title",
			searchAssetType = "Blogs Entry"
		);

		Navigator.gotoPage(pageName = "Blogs Page");

		Search.removeUserFacetDisplayPG();

		Navigator.gotoPage(pageName = "Blogs Page");

		Search.searchPG(searchTerm = "Entry");

		AssertTextNotPresent(
			locator1 = "SearchResults#USER_FACET_ANY_USER",
			value1 = "Any User"
		);
	}

	@priority = "4"
	test SearchDeletedWebContent {
		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContentNavigator.gotoAddCP();

		WebContent.addCP(webContentContent = "WC Content", webContentTitle = "WC Title");

		PortletEntry.publish();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContent.moveToRecycleBinCP(
			assetType = "Web Content Article",
			webContentTitle = "WC Title"
		);

		Navigator.openURL();

		Search.searchPG(searchTerm = "WC Title");

		AssertTextEquals.assertPartialText(
			locator1 = "Message#EMPTY_INFO",
			value1 = "No results were found that matched the keywords"
		);
	}

	@priority = "4"
	test SearchEntriesByPortletsAndModifiedRangeFacet {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Blogs"
		);

		Blogs.addEntry(
			entryContent = "Blogs Entry1 AssetContent",
			entryTitle = "Blogs Entry1 Title"
		);

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Blogs"
		);

		Blogs.addEntry(
			entryContent = "Blogs Entry2 Content",
			entryTitle = "Blogs Entry2 Title"
		);

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContentNavigator.gotoAddCP();

		WebContent.addCP(
			webContentContent = "WC WebContent1 Content",
			webContentTitle = "WC WebContent1 Title"
		);

		PortletEntry.publish();

		Portlet.changeDisplayStyle(displayStyle = "Descriptive");

		WebContent.viewTitle(webContentTitle = "WC WebContent1 Title");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContentNavigator.gotoAddCP();

		WebContent.addCP(
			webContentContent = "WC WebContent2 AssetContent",
			webContentTitle = "WC WebContent2 Title"
		);

		PortletEntry.publish();

		WebContent.viewTitle(webContentTitle = "WC WebContent2 Title");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Wiki"
		);

		WikiNavigator.gotoNode(wikiNodeName = "Main");

		WikiNavigator.gotoAllPagesCP();

		WikiPage.addCP(
			wikiPageContent = "Wiki Page1 Content",
			wikiPageTitle = "Wiki Page1 Title"
		);

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Wiki"
		);

		WikiNavigator.gotoNode(wikiNodeName = "Main");

		WikiNavigator.gotoAllPagesCP();

		WikiPage.addCP(
			wikiPageContent = "Wiki Page2 AssetContent",
			wikiPageTitle = "Wiki Page2 Title"
		);

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Documents and Media"
		);

		DMDocument.addCP(
			dmDocumentDescription = "DM Document AssetContent Description ",
			dmDocumentFile = "Document_1.doc",
			dmDocumentSize = "22k",
			dmDocumentTitle = "DM Document Title"
		);

		Navigator.openURL();

		Page.add(pageName = "Search Page");

		Navigator.gotoPage(pageName = "Search Page");

		Search.searchPG(searchTerm = '''"AssetContent"''');

		for (var searchAssetTitle : list "Blogs Entry1 Title,WC WebContent2 Title,Wiki Page2 Title,DM Document Title") {
			var key_searchAssetTitle = "${searchAssetTitle}";

			AssertTextEquals(
				locator1 = "SearchResults#ASSET_ENTRY_TABLE_TITLE",
				value1 = "${searchAssetTitle}"
			);
		}

		for (var searchAssetTitle : list "Blogs Entry2 Title,WC WebContent1 Title,Wiki Page1 Title") {
			var key_searchAssetTitle = "${searchAssetTitle}";

			AssertTextNotPresent(
				locator1 = "SearchResults#ASSET_ENTRY_TABLE_TITLE",
				value1 = "${searchAssetTitle}"
			);
		}

		Search.viewAssetTypeFacetPG(
			facetFrequency = "1",
			searchAssetTitle = "Wiki Page2 Title",
			searchAssetType = "Wiki Page"
		);

		Search.unscopeAssetFacetPG();

		Search.gotoModifiedRangeFacetPG(searchModifiedRange = "Past Month");

		for (var searchAssetTitle : list "Blogs Entry1 Title,WC WebContent2 Title,Wiki Page2 Title,DM Document Title") {
			var key_searchAssetTitle = "${searchAssetTitle}";

			AssertTextEquals(
				locator1 = "SearchResults#ASSET_ENTRY_TABLE_TITLE",
				value1 = "${searchAssetTitle}"
			);
		}

		for (var searchAssetTitle : list "Blogs Entry2 Title,WC WebContent1 Title,Wiki Page1 Title") {
			var key_searchAssetTitle = "${searchAssetTitle}";

			AssertTextNotPresent(
				locator1 = "SearchResults#ASSET_ENTRY_TABLE_TITLE",
				value1 = "${searchAssetTitle}"
			);
		}
	}

	@description = "This is a use case for LPS-25877."
	@priority = "5"
	test SearchPortletIdAfterLogout {
		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		Organization.addCP(orgName = "Organization Name", orgType = "Organization");

		User.logoutPG();

		Search.searchPG(
			searchTerm = "portletId:com_liferay_users_admin_web_portlet_UsersAdminPortlet"
		);

		Search.viewSearchNoPG(searchAssetTitle = "Test Test", searchAssetType = "User");

		Search.viewSearchNoPG(
			searchAssetTitle = "Organization Name",
			searchAssetType = "Organization"
		);
	}

	@priority = "5"
	test SearchTwiceHideSitesFacet {
		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea1@liferay.com",
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea2@liferay.com",
			userFirstName = "userfn2",
			userLastName = "userln2",
			userScreenName = "usersn2"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Site Page", siteName = "Site Name");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Members",
			panel = "Site Administration",
			portlet = "Site Memberships"
		);

		Site.assignUserAsMemberCP(
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Portlet.gotoPortletOptions(
			portletName = "Search",
			portletOption = "Configuration"
		);

		Search.configureSearchScopePG(
			searchScope = "Let the User Choose",
			uncheckDisplayFacet = "Sites"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchScope = "This Site", searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchNoPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchScope = "Everything", searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);
	}

	@priority = "5"
	test SearchTwiceScopeEverything {
		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea1@liferay.com",
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea2@liferay.com",
			userFirstName = "userfn2",
			userLastName = "userln2",
			userScreenName = "usersn2"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Site Page", siteName = "Site Name");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Members",
			panel = "Site Administration",
			portlet = "Site Memberships"
		);

		Site.assignUserAsMemberCP(
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Portlet.gotoPortletOptions(
			portletName = "Search",
			portletOption = "Configuration"
		);

		Search.configureSearchScopePG(searchScope = "Everything");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);

		Refresh();

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);
	}

	@priority = "5"
	test SearchTwiceScopeLetUserChoose {
		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea1@liferay.com",
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea2@liferay.com",
			userFirstName = "userfn2",
			userLastName = "userln2",
			userScreenName = "usersn2"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Site Page", siteName = "Site Name");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Members",
			panel = "Site Administration",
			portlet = "Site Memberships"
		);

		Site.assignUserAsMemberCP(
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Portlet.gotoPortletOptions(
			portletName = "Search",
			portletOption = "Configuration"
		);

		Search.configureSearchScopePG(searchScope = "Let the User Choose");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchScope = "This Site", searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchNoPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchScope = "Everything", searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);

		Refresh();

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);
	}

	@priority = "5"
	test SearchTwiceScopeThisSite {
		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea1@liferay.com",
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		ProductMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations"
		);

		User.addCP(
			userEmailAddress = "userea2@liferay.com",
			userFirstName = "userfn2",
			userLastName = "userln2",
			userScreenName = "usersn2"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Site Page", siteName = "Site Name");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Members",
			panel = "Site Administration",
			portlet = "Site Memberships"
		);

		Site.assignUserAsMemberCP(
			userFirstName = "userfn1",
			userLastName = "userln1",
			userScreenName = "usersn1"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Portlet.gotoPortletOptions(
			portletName = "Search",
			portletOption = "Configuration"
		);

		Search.configureSearchScopePG(searchScope = "This Site");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchNoPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Site Name");

		Search.searchPG(searchTerm = "usersn");

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchNoPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);

		Refresh();

		Search.viewSearchResultPG(
			searchAssetTitle = "userfn1 userln1",
			searchAssetType = "User"
		);

		Search.viewSearchNoPG(
			searchAssetTitle = "userfn2 userln2",
			searchAssetType = "User"
		);
	}

	@priority = "4"
	test SearchXSSAsset {
		Page.add(pageName = "Message Boards Page");

		Portlet.addPG(portletName = "Message Boards");

		Navigator.gotoPage(pageName = "Message Boards Page");

		MessageboardsThread.addPG(
			threadBody = '''<script>alert(123);</script>''',
			threadSubject = "Thread Subject"
		);

		Search.searchPG(searchTerm = "Liferay Alert");

		Search.viewSearchResultPG(
			searchAssetTitle = "Thread Subject",
			searchAssetType = "Message Boards Message",
			searchAssetSummary = '''<script>alert(123);</script>'''
		);

		AssertAlertNotPresent();

		var actualScript = '''<script>alert(123);</script>''';

		var escapedScript = '''&lt;script&gt;<span class="highlight">alert</span>(123);&lt;/script&gt;''';

		AssertHTMLSourceTextNotPresent(value1 = "${actualScript}");

		AssertHTMLSourceTextPresent(value1 = "${escapedScript}");
	}

	@priority = "4"
	test ViewStagedAndLiveContentInSearchResults {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Staging Test Page", siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Publishing",
			panel = "Site Administration",
			portlet = "Staging"
		);

		Staging.activateStagingCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContent.addArticleCP(
			webContentContent = "WebContent Content",
			webContentTitle = "WebContent Title"
		);

		Navigator.gotoStagedSitePage(
			pageName = "Staging Test Page",
			siteName = "Site Name"
		);

		Search.searchPG(searchTerm = "Web Content Article");

		SearchPortlet.viewSearchResultsPG(
			searchAssetTitle = "WebContent Title",
			searchAssetType = "Web Content Article"
		);

		ProductMenu.gotoLiveSite();

		Search.searchPG(searchTerm = "Web Content Article");

		SearchPortlet.viewSearchNoAssetTitle(searchAssetTitle = "WebContent Title");

		Navigator.gotoStagedView();

		Staging.gotoPublishToLive();

		Staging.publishToLive();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Web Content"
		);

		WebContent.deleteStagedCP(
			pageName = "Staging Test Page",
			siteName = "Site Name",
			webContentTitle = "WebContent Title"
		);

		Navigator.gotoStagedSitePage(
			pageName = "Staging Test Page",
			siteName = "Site Name"
		);

		Search.searchPG(searchTerm = "Web Content Article");

		SearchPortlet.viewSearchNoAssetTitle(searchAssetTitle = "WebContent Title");

		ProductMenu.gotoLiveSite();

		Search.searchPG(searchTerm = "Web Content Article");

		SearchPortlet.viewSearchResultsPG(
			searchAssetTitle = "WebContent Title",
			searchAssetType = "Web Content Article"
		);
	}

	@priority = "4"
	test ViewUserSearchResult {
		property test.name.skip.portal.instance = "SearchUsecase#ViewUserSearchResult";

		ProductMenu.gotoPortlet(
			category = "Configuration",
			panel = "Control Panel",
			portlet = "Server Administration"
		);

		ServerAdministration.executeServerResourcesActions(
			actionsDescription = "Reindex all search indexes."
		);

		Navigator.openURL();

		Page.add(pageName = "Search Page");

		Navigator.gotoPage(pageName = "Search Page");

		Navigator.gotoPage(pageName = "Search Page");

		Search.searchPG(searchTerm = "Test Test");

		Search.viewSearchAssetTitle(searchAssetTitle = "Test Test");

		Search.gotoUserSearchResultPG(searchAssetTitle = "Test Test");

		Search.viewUserSearchResultPG(pageName = "Welcome", userName = "Test Test");
	}
}