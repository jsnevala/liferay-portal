@component-name = "portal-wcm"
definition {
	property portal.release = "true";
	property portal.upstream = "true";
	property testray.main.component.name = "Site Administration";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();
	}

	tearDown {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if ("${testPortalInstance}" == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			Site.tearDownCP();
		}
	}

	@priority = "4"
	test AddChildChildSite {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(parentSiteName = "Site Name", siteName = "Child SiteName");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(
			parentSiteName = "Child SiteName",
			siteName = "Child Child SiteName"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewChildCP(childSiteName = "Child SiteName", siteName = "Site Name");

		Site.viewChildCP(
			childSiteName = "Child Child SiteName",
			siteName = "Child SiteName"
		);
	}

	@priority = "5"
	test AddChildSite {
		property testray.component.names = "Training";

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(parentSiteName = "Site Name", siteName = "Child SiteName");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewChildCP(childSiteName = "Child SiteName", siteName = "Site Name");
	}

	@priority = "3"
	test AddPublicVirtualHostsSiteURL {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		SitePageNavigator.gotoPages(page = "Public Pages");

		Page.add(pageName = "Test Public Page");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Configuration",
			panel = "Site Administration",
			portlet = "Site Settings"
		);

		Site.addVirtualHostsURLCP(
			publicPageVirtualHostURL = "www.able.com",
			publicVirtualHosts = "true"
		);

		Navigator.openSpecificURL(url = "http://www.able.com:8080/test-public-page");

		Site.viewVirtualHostsURLPG(
			pageName = "Test Public Page",
			siteName = "Site Name",
			sitePageURL = "http://www.able.com:8080/test-public-page"
		);
	}

	@description = "Ensure that the super admin can add a Blank Site"
	@priority = "4"
	test AddSite {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCP(siteName = "Site Name");
	}

	@priority = "4"
	test AddSitesMultiple {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site1 Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCP(siteName = "Site1 Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addCommunityCP(siteName = "Site2 Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCP(siteName = "Site2 Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addIntranetCP(siteName = "Site3 Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCP(siteName = "Site3 Name");
	}

	@priority = "3"
	test AddSiteWithCommaInName {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name,");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCP(siteName = "Site Name,");
	}

	@priority = "3"
	test AddSiteWithInvalidDuplicateName {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCannotAdd(siteName = "Site Name", siteNameInvalid = "Duplicate");
	}

	@priority = "3"
	test AddSiteWithInvalidName {
		for (var siteName : list "Site Name*,22222") {
			ProductMenu.gotoPortlet(
				category = "Sites",
				panel = "Control Panel",
				portlet = "Sites"
			);

			Site.viewCannotAdd(siteName = "${siteName}", siteNameInvalid = "Invalid");
		}
	}

	@priority = "3"
	test AddSiteWithNullName {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCannotAdd(siteName = " ", siteNameInvalid = "Null");
	}

	@priority = "5"
	test DeleteSite {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.deleteCP(siteName = "Site Name");
	}

	@priority = "5"
	test EditSite {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Configuration",
			panel = "Site Administration",
			portlet = "Site Settings"
		);

		Site.editCP(siteName = "Site Name", siteNameEdit = "Site Name Edit");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewCP(siteName = "Site Name Edit");
	}

	@priority = "4"
	test EditSiteFriendlyURL {
		var portalURL = PropsUtil.get("portal.url");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		SitePageNavigator.gotoPages(page = "Public Pages");

		Page.add(pageName = "Test Public Page");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(
			pageName = "Test Private Page",
			siteName = "Site Name",
			sitePagePrivacy = "Private"
		);

		ProductMenu.gotoPortlet(
			category = "Configuration",
			panel = "Site Administration",
			portlet = "Site Settings"
		);

		Site.editFriendlyURLCP(siteFriendlyURLEdit = "alpha");

		Navigator.openSiteURL(siteName = "alpha");

		Site.viewSiteFriendlyURLPG(
			pageName = "Public Page",
			siteName = "Site Name",
			sitePageURL = "${portalURL}/web/alpha"
		);

		Navigator.openPrivateSiteURL(siteName = "alpha");

		Site.viewSiteFriendlyURLPG(
			pageName = "Private Page",
			siteName = "Site Name",
			sitePageURL = "${portalURL}/group/alpha"
		);
	}

	@priority = "3"
	test EditSiteFriendlyURLInvalid {
		property test.name.skip.portal.instance = "CPSites#EditSiteFriendlyURLInvalid";

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		SitePageNavigator.gotoPages(page = "Public Pages");

		Page.add(pageName = "Site Page");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Configuration",
			panel = "Site Administration",
			portlet = "Site Settings"
		);

		Site.editFriendlyURLCP(
			friendlyURLInvalid = "true",
			siteFriendlyURL = "/site-name",
			siteFriendlyURLEdit = "/alpha/alpha"
		);

		SitePageNavigator.gotoPages(page = "Public Pages");

		Page.viewFriendlyURL(pageName = "Site Page", siteFriendlyURL = "/site-name");
	}

	@priority = "5"
	test SearchSite {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.searchCP(siteName = "Site Name");
	}

	@priority = "3"
	test SiteCannotBeItsOwnParent {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addCommunityCP(siteName = "Site Name");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Configuration",
			panel = "Site Administration",
			portlet = "Site Settings"
		);

		Site.selectParentSite(
			chooseButtonAvailable = "false",
			parentSiteName = "Site Name"
		);
	}

	@priority = "3"
	test SiteCannotBeItsOwnParentStaging {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addCommunityCP(siteName = "Site Name", uncheckPropagation = "true");

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Publishing",
			panel = "Site Administration",
			portlet = "Staging"
		);

		Staging.activateStagingCP(siteName = "Site Name");

		Navigator.gotoStagedSitePage(pageName = "Home", siteName = "Site Name");

		Staging.viewStagingLocalLivePG();

		ProductMenu.gotoSite(site = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Configuration",
			panel = "Site Administration",
			portlet = "Site Settings"
		);

		Site.selectParentSite(
			chooseButtonAvailable = "false",
			parentSiteName = "Site Name"
		);
	}

	@priority = "4"
	test ViewDisplayParentSiteViaSitesDirectory {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Site Page", siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(parentSiteName = "Site Name", siteName = "Child SiteName");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.searchInputCP(siteName = "Child SiteName");

		Page.add(pageName = "Site Page", siteName = "Child SiteName");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(
			parentSiteName = "Child SiteName",
			siteName = "Child ChildSiteName"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.searchInputCP(siteName = "Child ChildSiteName");

		Page.add(pageName = "Site Page", siteName = "Child ChildSiteName");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.viewChildCP(childSiteName = "Child SiteName", siteName = "Site Name");

		Site.viewChildCP(
			childSiteName = "Child ChildSiteName",
			siteName = "Child SiteName"
		);

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Child SiteName");

		Portlet.addPG(portletName = "Sites Directory");

		SitesDirectory.configureSetupPG(directorySites = "Parent Level");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Child SiteName");

		SitesDirectory.viewDescriptivePG(siteName = "Site Name");
	}

	@priority = "4"
	test ViewSiteHierarchiesViaSitesDirectory {
		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Page.add(pageName = "Site Page", siteName = "Site Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(parentSiteName = "Site Name", siteName = "Child Site1Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.searchInputCP(siteName = "Child Site1Name");

		Page.add(pageName = "Site Page", siteName = "Child Site1Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(
			parentSiteName = "Child Site1Name",
			siteName = "Child ChildSite1Name"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.searchInputCP(siteName = "Child ChildSite1Name");

		Page.add(pageName = "Site Page", siteName = "Child ChildSite1Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(
			parentSiteName = "Child Site1Name",
			siteName = "Child ChildSite2Name"
		);

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.searchInputCP(siteName = "Child ChildSite2Name");

		Page.add(pageName = "Site Page", siteName = "Child ChildSite2Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.addBlankCP(parentSiteName = "Site Name", siteName = "Child Site2Name");

		ProductMenu.gotoPortlet(
			category = "Sites",
			panel = "Control Panel",
			portlet = "Sites"
		);

		Site.searchInputCP(siteName = "Child Site2Name");

		Page.add(pageName = "Site Page", siteName = "Child Site2Name");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Child Site1Name");

		Portlet.addPG(portletName = "Sites Directory");

		SitesDirectory.configureSetupPG(directorySites = "Top Level");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Child Site1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Site Name");

		SitesDirectory.configureSetupPG(directorySites = "Parent Level");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Child Site1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Site Name");

		SitesDirectory.configureSetupPG(directorySites = "Siblings");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Child Site1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Child Site1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Child Site2Name");

		SitesDirectory.configureSetupPG(directorySites = "Children");

		Navigator.gotoSitePage(pageName = "Site Page", siteName = "Child Site1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Child ChildSite1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Child ChildSite2Name");

		Navigator.gotoSitePage(
			pageName = "Site Page",
			siteName = "Child ChildSite1Name"
		);

		Portlet.addPG(portletName = "Sites Directory");

		SitesDirectory.configureSetupPG(directorySites = "Top Level");

		Navigator.gotoSitePage(
			pageName = "Site Page",
			siteName = "Child ChildSite1Name"
		);

		SitesDirectory.viewDescriptivePG(siteName = "Site Name");

		SitesDirectory.configureSetupPG(directorySites = "Parent Level");

		Navigator.gotoSitePage(
			pageName = "Site Page",
			siteName = "Child ChildSite1Name"
		);

		SitesDirectory.viewDescriptivePG(siteName = "Child Site1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Child Site2Name");

		SitesDirectory.configureSetupPG(directorySites = "Siblings");

		Navigator.gotoSitePage(
			pageName = "Site Page",
			siteName = "Child ChildSite1Name"
		);

		SitesDirectory.viewDescriptivePG(siteName = "Child ChildSite1Name");

		SitesDirectory.viewDescriptivePG(siteName = "Child ChildSite2Name");

		SitesDirectory.configureSetupPG(directorySites = "Children");

		Navigator.gotoSitePage(
			pageName = "Site Page",
			siteName = "Child ChildSite1Name"
		);

		AssertTextEquals(
			locator1 = "Message#EMPTY_INFO",
			value1 = "No sites were found."
		);
	}
}