@component-name = "portal-workflow"
definition {
	property portal.release = "true";
	property portal.upstream = "true";
	property testray.main.component.name = "Workflow";

	setUp {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if ("${testPortalInstance}" == "true") {
			SignIn.signInPortalInstanceSetUp();
		}

		User.firstLoginPG();
	}

	tearDown {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if ("${testPortalInstance}" == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			Navigator.openURL();

			ProductMenu.gotoPortlet(
				category = "Content",
				panel = "Site Administration",
				portlet = "Forms"
			);

			FormsAdmin.teardownForms();

			Page.tearDownPG();
		}
	}

	@description = "This is a use case for LPS-62371"
	@priority = "3"
	test SubmitPublishedFormWithTextField {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		LexiconEntry.gotoAdd();

		Form.editName();

		Form.editDescription();

		Form.gotoAddField(fieldType = "Text Field");

		Form.editFieldLabel(fieldValue = "Text Field");

		FormFields.save();

		FormsAdminNavigator.gotoSettings();

		Form.configureWorkflow(workflowDefinition = "Single Approver (Version 1)");

		Form.save();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		FormsAdminNavigator.gotoEditFormByName();

		FormsAdminNavigator.gotoPublish();

		Form.clickPublishSwitcher();

		Button.clickConfirm();

		FormsAdminNavigator.openPublishURL();

		FormFields.editText(fieldName = "TextField", fieldValue = "Text Field Value");

		Button.clickSubmitForPublication();

		Alert.viewSuccessMessage();

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		FormsAdminNavigator.gotoViewEntries();

		WorkflowAsset.viewFormEntryTable(
			fieldLabel = "Text Field",
			fieldValue = "Text Field Value",
			workflowStatus = "Pending"
		);

		Page.gotoMyAccount(portletName = "My Workflow Tasks");

		Workflow.assignToMeTaskByDetails(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewTaskAssignedToMe(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewTaskAssignedToMeDetails(
			workflowAssetContent = "Text",
			workflowAssetTitle = "Created Form Name",
			workflowTask = "Review"
		);

		Page.gotoMyAccount(portletName = "My Workflow Tasks");

		Workflow.approveTaskByActions(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewCompletedTask(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		FormsAdminNavigator.gotoViewEntries();

		WorkflowAsset.viewFormEntryTable(
			fieldLabel = "Text Field",
			fieldValue = "Text Field Value",
			workflowStatus = "Approved"
		);
	}

	@description = "This is a use case LPS-61197."
	@priority = "5"
	test ViewDateAssetDetails {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		LexiconEntry.gotoAdd();

		Form.editName();

		Form.editDescription();

		Form.gotoAddField(fieldType = "Date");

		Form.editFieldLabel(fieldValue = "Date");

		FormFields.save();

		Form.save();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		LexiconEntry.gotoEntryMenuItem(
			menuItem = "Edit",
			rowEntry = "Created Form Name"
		);

		FormsAdminNavigator.gotoSettings();

		Form.configureWorkflow(workflowDefinition = "Single Approver (Version 1)");

		Form.save();

		Page.add(pageName = "Form Page");

		Navigator.gotoPage(pageName = "Form Page");

		Portlet.addPG(pageName = "Form Page", portletName = "Form");

		FormPortletNavigator.gotoSelectForm();

		FormPortletConfiguration.selectForm();

		PortletEntry.save();

		Navigator.gotoPage(pageName = "Form Page");

		FormFields.viewDateLabel(fieldLabel = "Date", fieldName = "Date");

		FormFields.editDate(fieldName = "Date", fieldValue = "02/01/2016");

		Button.clickSubmitForPublication();

		Alert.viewSuccessMessage();

		Page.gotoMyAccount(portletName = "My Workflow Tasks");

		Workflow.assignToMeTaskByDetails(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewTaskAssignedToMe(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewTaskAssignedToMeDetails(
			workflowAssetContent = "Date",
			workflowAssetTitle = "Created Form Name",
			workflowTask = "Review"
		);

		Workflow.gotoPreviewView();

		FormFields.viewDateField(fieldLabel = "Date", fieldName = "Date");

		Page.gotoMyAccount(portletName = "My Workflow Tasks");

		Workflow.approveTaskByActions(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewCompletedTask(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);
	}

	@description = "This is a use case for LPS-65270."
	@priority = "3"
	test ViewEntryWithConditionalVisibilityFromSelectAndRadio {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		LexiconEntry.gotoAdd();

		Form.editName();

		Form.editDescription();

		Form.gotoAddField(fieldType = "Select from List");

		Form.editFieldLabel(fieldValue = "Select");

		FormFields.editOptionsRow(optionName = "Select1", optionValue = "Select 1");

		FormFields.save();

		Form.gotoAddField(fieldType = "Text Field");

		Form.editFieldLabel(fieldValue = "Text One");

		FormFields.enableAdvancedOptions();

		FormFields.editText(
			fieldName = "visibility",
			fieldValue = "equals(Select, &quot;Select1&quot;)"
		);

		FormFields.save();

		Form.gotoAddField(fieldType = "Single Selection");

		Form.editFieldLabel(fieldValue = "Radio");

		FormFields.editOptionsRow(optionName = "Option1", optionValue = "Option 1");

		FormFields.save();

		Form.gotoAddField(fieldType = "Text Field");

		Form.editFieldLabel(fieldValue = "Text Two");

		FormFields.enableAdvancedOptions();

		FormFields.editText(
			fieldName = "visibility",
			fieldValue = "equals(Radio, &quot;Option1&quot;)"
		);

		FormFields.save();

		FormsAdminNavigator.gotoSettings();

		Form.configureWorkflow(workflowDefinition = "Single Approver (Version 1)");

		Form.save();

		Page.add(pageName = "Form Page");

		Navigator.gotoPage(pageName = "Form Page");

		Portlet.addPG(pageName = "Form Page", portletName = "Form");

		FormPortletNavigator.gotoSelectForm();

		FormPortletConfiguration.selectForm();

		PortletEntry.save();

		Navigator.gotoPage(pageName = "Form Page");

		FormFields.viewTextFieldNotVisible(
			fieldLabel = "Text One",
			fieldName = "TextOne",
			fieldValue = "Text One Input"
		);

		FormFields.selectSelectOption(fieldName = "Select", selectOption = "Select 1");

		FormFields.editText(fieldName = "TextOne", fieldValue = "Text One Input");

		FormFields.viewTextFieldNotVisible(
			fieldLabel = "Text Two",
			fieldName = "TextTwo",
			fieldValue = "Text Two Input"
		);

		FormFields.selectRadioOption(fieldName = "Radio", radioOption = "Option 1");

		FormFields.editText(fieldName = "TextTwo", fieldValue = "Text Two Input");

		Button.clickSubmitForPublication();

		Alert.viewSuccessMessage();

		Page.gotoMyAccount(portletName = "My Workflow Tasks");

		Workflow.assignToMeTaskByDetails(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewTaskAssignedToMe(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Workflow.viewTaskAssignedToMeDetails(
			workflowAssetContent = "Text Two",
			workflowAssetTitle = "Created Form Name",
			workflowTask = "Review"
		);

		Workflow.gotoPreviewView();

		FormsAdmin.viewSelectEntry(
			fieldLabel = "Select",
			fieldName = "Select",
			selectOption = "Select 1"
		);

		FormsAdmin.viewTextEntry(
			fieldLabel = "Text One",
			fieldName = "TextOne",
			fieldValue = "Text One Input"
		);

		FormsAdmin.viewRadioEntry(
			fieldLabel = "Radio",
			fieldName = "Radio",
			fieldValue = "Option 1"
		);

		FormsAdmin.viewTextEntry(
			fieldLabel = "Text Two",
			fieldName = "TextTwo",
			fieldValue = "Text Two Input"
		);

		Page.gotoMyAccount(portletName = "My Workflow Tasks");

		Workflow.approveTaskByActions(
			workflowAssetTitle = "Created Form Name",
			workflowAssetType = "Form Record",
			workflowTask = "Review"
		);

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Forms"
		);

		FormsAdminNavigator.gotoViewEntries();

		FormsAdmin.viewFormTableEntry(fieldLabel = "Select", fieldValue = "Select 1");

		FormsAdmin.viewFormTableEntry(
			fieldLabel = "Text One",
			fieldValue = "Text One Input"
		);

		FormsAdmin.viewFormTableEntry(fieldLabel = "Radio", fieldValue = "Option 1");

		FormsAdmin.viewFormTableEntry(
			fieldLabel = "Text Two",
			fieldValue = "Text Two Input"
		);

		FormsAdminNavigator.gotoView();

		FormsAdmin.viewSelectEntry(
			fieldLabel = "Select",
			fieldName = "Select",
			selectOption = "Select 1"
		);

		FormsAdmin.viewTextEntry(
			fieldLabel = "Text One",
			fieldName = "TextOne",
			fieldValue = "Text One Input"
		);

		FormsAdmin.viewRadioEntry(
			fieldLabel = "Radio",
			fieldName = "Radio",
			fieldValue = "Option 1"
		);

		FormsAdmin.viewTextEntry(
			fieldLabel = "Text Two",
			fieldName = "TextTwo",
			fieldValue = "Text Two Input"
		);
	}
}