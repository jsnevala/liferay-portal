@component-name = "portal-tags"
definition {
	property portal.release = "true";
	property portal.upstream = "true";
	property testray.main.component.name = "Tags";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();
	}

	tearDown {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if ("${testPortalInstance}" == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			Tag.tearDownCP();
		}
	}

	@priority = "5"
	test AddTag {
		property portal.acceptance = "true";

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "tag name");

		Tag.viewCP(tagName = "tag name");
	}

	@priority = "4"
	test AddTagInvalidCharacters {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''&tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = "&apos;tag&apos;");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''*tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''@tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''\test''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''[tag]''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''>tag<''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''{tag}''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = ''':tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = ''',tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "tag name");

		Tag.addInvalidCP(tagName = "tag name");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''=tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''/test''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addWithNullTitleCP(tagName = " ");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''%tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''+tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''#tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''?tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''"tag"''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = ''';tag''');

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addInvalidCP(tagName = '''~tag''');
	}

	@priority = "4"
	test AddTags {
		for (var n : list "1,2,3") {
			Navigator.openURL();

			ProductMenu.gotoPortlet(
				category = "Content",
				panel = "Site Administration",
				portlet = "Tags"
			);

			Tag.addCP(tagName = "tag name ${n}");
		}

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.viewTagsCP(
			tagName1 = "tag name 1",
			tagName2 = "tag name 2",
			tagName3 = "tag name 3"
		);
	}

	@priority = "4"
	test AddTagWithUTF8Encoding {
		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "標籤名稱");

		Tag.viewCP(tagName = "標籤名稱");
	}

	@priority = "4"
	test DeleteTagFromList {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "tag name");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.deleteCP(deleteMethod = "From List", tagName = "tag name");
	}

	@priority = "4"
	test DeleteTagFromToolbar {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "tag name");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.deleteCP(deleteMethod = "From Toolbar", tagName = "tag name");
	}

	@priority = "5"
	test EditTag {
		property portal.acceptance = "true";

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "tag name");

		Tag.editCP(tagName = "tag name", tagNameEdit = "tag name edit");

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.viewCP(tagName = "tag name edit");
	}

	@priority = "4"
	test EditTagCancel {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "tag name");

		Tag.editCancelCP(tagName = "tag name");
	}

	@priority = "3"
	test MergeMultipleTags {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		for (var n : list "1,2,3") {
			Tag.addCP(tagName = "tag name ${n}");
		}

		Tag.mergeTags(
			mergeConfirmation = '''Are you sure you want to merge "tag name 1,tag name 2,tag name 3" into "tag name 2"? This will change all items tagged with "tag name 1,tag name 2,tag name 3" to instead be tagged with "tag name 2".''',
			selectTagToMergeTo = "tag name 2"
		);

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.viewCP(tagName = "tag name 2");

		for (var tagName : list "tag name 1,tag name 3") {
			Tag.viewMergedTagsCP(tagName = "${tagName}");
		}
	}

	@priority = "3"
	test MergeSingleTagWarning {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.addCP(tagName = "tag name");

		Tag.mergeSingleTagWarning(tagName = "tag name");
	}

	@priority = "5"
	test SearchTag {
		property portal.acceptance = "true";

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		for (var n : list "1,2,3") {
			Tag.addCP(tagName = "tag name ${n}");
		}

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Tags"
		);

		Tag.searchTagCP(
			tagName1 = "tag name 1",
			tagName2 = "tag name 2",
			tagName3 = "tag name 3"
		);
	}
}